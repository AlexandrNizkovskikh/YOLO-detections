# -*- coding: utf-8 -*-
"""–î–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–µ —Å –ø–æ–º–æ—â—å—é YOLO: –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è.ipynb"

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1KyMUfKO63xJUY4DnmpPULjwiMIGZEHyY

# –î–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–µ —Å –ø–æ–º–æ—â—å—é YOLO: –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
_____________

### üñ• –Ø–∑—ã–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è  
![Python](https://img.shields.io/badge/-Python-3776AB?logo=python&logoColor=white&style=for-the-badge)

### üì¶ –§—Ä–µ–π–º–≤–æ—Ä–∫–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏  
![Ultralytics YOLO](https://img.shields.io/badge/-YOLO-00FFFF?logo=yolo&logoColor=black&style=for-the-badge)  
![FiftyOne](https://img.shields.io/badge/-FiftyOne-FF4081?logo=python&logoColor=white&style=for-the-badge)  
![OpenCV](https://img.shields.io/badge/-OpenCV-5C3EE8?logo=opencv&logoColor=white&style=for-the-badge)  
![NumPy](https://img.shields.io/badge/-NumPy-013243?logo=numpy&logoColor=white&style=for-the-badge)  
![Pillow](https://img.shields.io/badge/-Pillow-3776AB?logo=python&logoColor=white&style=for-the-badge)  
![TQDM](https://img.shields.io/badge/-TQDM-FFA500?logo=python&logoColor=white&style=for-the-badge)  

### ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ —É—Å–∫–æ—Ä–µ–Ω–∏–µ  
![FP16](https://img.shields.io/badge/-FP16-6E4C13?logo=nvidia&logoColor=white&style=for-the-badge)  
![Batch Processing](https://img.shields.io/badge/-Batch%20Processing-4CAF50?logo=python&logoColor=white&style=for-the-badge)  
![FFmpeg](https://img.shields.io/badge/-FFmpeg-007808?logo=ffmpeg&logoColor=white&style=for-the-badge)  

### üìÇ –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏  
![VisDrone2019-VID](https://img.shields.io/badge/-VisDrone2019-VID-blue?logo=databricks&logoColor=white&style=for-the-badge)  
![Tabulate](https://img.shields.io/badge/-Tabulate-FF6F00?logo=python&logoColor=white&style=for-the-badge)  

### üîß –°—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã  
![Google Colab](https://img.shields.io/badge/-Google%20Colab-F9AB00?logo=googlecolab&logoColor=white&style=for-the-badge)  
![gdown](https://img.shields.io/badge/-gdown-3776AB?logo=google-drive&logoColor=white&style=for-the-badge)  
![Subprocess](https://img.shields.io/badge/-Subprocess-6A5ACD?logo=python&logoColor=white&style=for-the-badge)  

###–ö—Ä–∞—Ç–∫–∞—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è

–í –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ –∏—Å—Å–ª–µ–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π YOLO –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–µ. –ë—ã–ª–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω—ã –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã, –≤–∫–ª—é—á–∞—é—â–∏–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π (YOLOv3, YOLOv5, YOLOv8, YOLOv11) –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ **FiftyOne** —Å –≤—ã–≤–æ–¥–æ–º –º–µ—Ç—Ä–∏–∫ —Ç–æ—á–Ω–æ—Å—Ç–∏: **precision**, **recall**, **f1-score**, **support**, –∞ —Ç–∞–∫–∂–µ —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (**micro/macro/weighted avg**).

–î–∞–ª–µ–µ –º–æ–¥–µ–ª–∏ –±—ã–ª–∏ —É–ª—É—á—à–µ–Ω—ã –∑–∞ —Å—á–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è **–ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏** –∏ **FP16**, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ —Å—Ä–∞–≤–Ω–∏—Ç—å –∏—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –∏ FPS. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∑–∞–¥–∞—á —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

##2. –£–°–¢–ê–ù–û–í–ö–ê –ò –ò–ú–ü–û–†–¢ –ë–ò–ë–õ–ò–û–¢–ï–ö
"""

!pip install -U ultralytics fiftyone> /dev/null 2>&1

import gdown
import os
from ultralytics import YOLO
import cv2
import os
import time
import fiftyone as fo
import fiftyone.utils.yolo as fouy
from PIL import Image
from tqdm import tqdm
import subprocess
import numpy as np
from tabulate import tabulate

"""##–¢–ï–û–†–ï–¢–ò–ß–ï–°–ö–ê–Ø –ß–ê–°–¢–¨

###–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–î–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–µ —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –∑–∞–¥–∞—á –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è. –û–Ω–∞ —à–∏—Ä–æ–∫–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫:

- –°–∏—Å—Ç–µ–º—ã –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–º–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
- –ê–Ω–∞–ª–∏–∑ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã

–û—Å–Ω–æ–≤–Ω–æ–π –≤—ã–∑–æ–≤ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–∏ **–≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤**, —á—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –≤ —É—Å–ª–æ–≤–∏—è—Ö:

- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ **—Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**

###–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

–î–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–µ –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –µ—ë —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –í –¥–∞–Ω–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –ª–µ–∂–∞—â–∏–µ –≤ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–π —Ä–∞–±–æ—Ç—ã:

- **YOLO (You Only Look Once):**  
  –≠—Ç–æ –≤—ã—Å–æ–∫–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏—Ö –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—é. –ì–ª–∞–≤–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å YOLO ‚Äî —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞ –æ–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥ —á–µ—Ä–µ–∑ —Å–µ—Ç—å, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –¥–ª—è –∑–∞–¥–∞—á —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

- **–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:**  
  –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–¥—Ä–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç –æ–±—â–µ–µ –≤—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –∏–¥–µ–∞–ª—å–Ω—ã–º –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–∞–º–∏ –≤—ã—Å–æ–∫–æ–π —á–∞—Å—Ç–æ—Ç—ã.

- **FP16 (Half Precision):**  
  –ú–µ—Ç–æ–¥ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —Å –ø–æ–ª–æ–≤–∏–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—Å–∫–æ—Ä–∏—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ GPU, –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è –ø—Ä–∏ —ç—Ç–æ–º –ø–æ—Ç–µ—Ä–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏, —á—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è –∑–∞–¥–∞—á, —Ç—Ä–µ–±—É—é—â–∏—Ö –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

- **FiftyOne:**  
  –ú–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö. FiftyOne —É–ø—Ä–æ—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–µ–π, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –∏ –≤–∏–¥–µ–æ.

–≠—Ç–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –æ—Å–Ω–æ–≤—É –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤, —á—Ç–æ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–µ—Ç –∏—Ö –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

###–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

–î–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–µ –æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Ä–µ—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ú–æ–¥–µ–ª–∏ YOLO –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –æ–¥–Ω–æ—Å—Ç–∞–¥–∏–π–Ω—ã–µ –¥–µ—Ç–µ–∫—Ç–æ—Ä—ã, –≥–¥–µ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–∏—Ö –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤:

- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ç–∫—É:**  
  –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—É—é —Å–µ—Ç–∫—É, –≥–¥–µ –∫–∞–∂–¥–∞—è —è—á–µ–π–∫–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤, —Ü–µ–Ω—Ç—Ä –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –µ—ë –ø—Ä–µ–¥–µ–ª–∞—Ö. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª—è–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

- **–†–µ–≥—Ä–µ—Å—Å–∏—è –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫:**  
  –î–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–π —Ä–∞–º–∫–∏:
  - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ —Ä–∞–º–∫–∏ (**x, y**)
  - –†–∞–∑–º–µ—Ä—ã —Ä–∞–º–∫–∏ (**w, h**)  
  –≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–Ω—ã–º–∏ –º–∞—Å—à—Ç–∞–±–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.

- **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤:**  
  –ö–∞–∂–¥—ã–π –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –±–æ–∫—Å —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º—É –∫–ª–∞—Å—Å—É. –î–ª—è –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –Ω–∞–ª–∏—á–∏—è –æ–±—ä–µ–∫—Ç–∞ –∏ –µ–≥–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∫–ª–∞—Å—Å—É.

–ú–µ—Ç—Ä–∏–∫–∏ –æ—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–∏

- **–¢–æ—á–Ω–æ—Å—Ç—å (Precision):** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∞—è –¥–æ–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É –∫–ª–∞—Å—Å—É.
- **–ü–æ–ª–Ω–æ—Ç–∞ (Recall):** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∞—è –¥–æ–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –±—ã–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞.
- **F1-Score:** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞, –∫–æ—Ç–æ—Ä–∞—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω–æ—Ç—É.
- **–°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (Macro, Micro, Weighted):** –ü–æ–∑–≤–æ–ª—è—é—Ç –æ–±–æ–±—â–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º, —É—á–∏—Ç—ã–≤–∞—è –∏—Ö –¥–∏—Å–±–∞–ª–∞–Ω—Å.

–≠—Ç–∏ –ø–æ–¥—Ö–æ–¥—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—Å–Ω–æ–≤—É –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –º–æ–¥–µ–ª—è–º YOLO –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –∑–∞–¥–∞—á —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

###–°—Ö–µ–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–ú–æ–¥–µ–ª–∏ —Å–µ–º–µ–π—Å—Ç–≤–∞ YOLO (YOLOv3, YOLOv5, YOLOv8 –∏ YOLOv11), –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ —Ä–∞–±–æ—Ç–µ, –∏–º–µ—é—Ç —Å—Ö–æ–∂–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ —Ä–∞–∑–ª–∏—á–∏—è–º–∏ –≤ –¥–µ—Ç–∞–ª—è—Ö. –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

- **–í—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π:**  
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (–æ–±—ã—á–Ω–æ 416√ó416 –∏–ª–∏ 640√ó640).  
  - –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –ø–∏–∫—Å–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –æ–±–ª–µ–≥—á–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏.

- **–°–µ—Ç—å —ç–∫—Å—Ç—Ä–∞–∫—Ü–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:**  
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Å–ª–æ–∏ (**Convolutional Layers**) –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.  
  - –ë–æ–ª–µ–µ –ø–æ–∑–¥–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ (YOLOv5, YOLOv8) –≤–∫–ª—é—á–∞—é—Ç —É–ª—É—á—à–µ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ **CSP-–±–ª–æ–∫–∏** –∏ —É–ª—É—á—à–µ–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (**Skip Connections**).

- **–°–µ—Ç–æ—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ö–æ–¥–æ–≤:**  
  - –†–∞–∑–±–∏–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—É—é —Å–µ—Ç–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, 13√ó13, 26√ó26 –∏ 52√ó52).  
  - –í –∫–∞–∂–¥–æ–π —è—á–µ–π–∫–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç:  
    - –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏ (**Bounding Boxes**)  
    - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ–±—ä–µ–∫—Ç–∞  
    - –ü—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫ –∫–ª–∞—Å—Å—É

- **–ì–æ–ª–æ–≤–Ω–∞—è —á–∞—Å—Ç—å (Head):**  
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∏–∑ —Å–µ—Ç–∏ —ç–∫—Å—Ç—Ä–∞–∫—Ü–∏–∏, –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.  
  - –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∫–ª—é—á–∞—é—Ç:  
    - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –±–æ–∫—Å–æ–≤ (**x, y, w, h**)  
    - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ–±—ä–µ–∫—Ç–∞  
    - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤

- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**  
  - YOLOv5 –∏ –≤—ã—à–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–∞–∫–µ—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ **FP16** –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã.

- **–ú–µ—Ö–∞–Ω–∏–∑–º –Ω–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥–∞–≤–ª–µ–Ω–∏—è (Non-Maximum Suppression):**  
  - –£–¥–∞–ª—è–µ—Ç –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ —Ä–∞–º–∫–∏, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.

–•–æ—Ç—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Å—Ö–æ–∂–∏, –∫–∞–∂–¥–∞—è –≤–µ—Ä—Å–∏—è YOLO –≤–Ω–æ—Å–∏—Ç —É–ª—É—á—à–µ–Ω–∏—è, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –ø–æ–≤—ã—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏. –≠—Ç–∏ —Ä–∞–∑–ª–∏—á–∏—è —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å –ø—Ä–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤.

##4. –ü–û–î–ì–û–¢–û–í–ö–ê –î–ê–ù–ù–´–•

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –±—ã–ª –≤—ã–±—Ä–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö VisDrone2019-VID. –≠—Ç–æ—Ç –¥–∞—Ç–∞—Å–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–∏ –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤. –î–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω—ã –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å —Å–ª–µ–¥—É—é—â–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π:

###–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

–ó–∞–≥—Ä—É–∑–∫–∞ –∞—Ä—Ö–∏–≤–∞ —Å –¥–∞–Ω–Ω—ã–º–∏:

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç gdown –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ —Å Google Drive –ø–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É
"""

file_id = "1230efb28xUv-C7uQC5Q6bW8DWYUcaJ8R"
output = "VisDrone2019-VID-test.zip"
gdown.download(f"https://drive.google.com/uc?id={file_id}", output, quiet=False)

"""–†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–∞:

–§–∞–π–ª —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–ª—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:
"""

!unzip VisDrone2019-VID-test.zip -d ./> /dev/null 2>&1

"""–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–µ–π:

–£–∫–∞–∑–∞–Ω—ã –ø—É—Ç–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º, –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º –∏ –≤—ã—Ö–æ–¥–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:
"""

images_dir = "./VisDrone2019-VID-test-dev/sequences/uav0000077_00720_v"
annotation_file = "./VisDrone2019-VID-test-dev/annotations/uav0000077_00720_v.txt"
labels_dir = "./VisDrone2019-VID-test-dev/annotations_yolo"

"""###–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞

–î–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏—Å—Ö–æ–¥–Ω—ã—Ö –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –≤ —Ñ–æ—Ä–º–∞—Ç YOLO –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–∞ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∫–ª—é—á–∞—é—Ç:

–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –≤ YOLO:

–ò—Å—Ö–æ–¥–Ω—ã–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ VisDrone –±—ã–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –º–æ–¥–µ–ª–∏ YOLO. –î–ª—è —ç—Ç–æ–≥–æ –±—ã–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è:
"""

def convert_folder_to_yolo(images_dir, annotation_file, labels_dir):
    """
    –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ VisDrone –≤ YOLO.

    Args:
        images_dir (str): –ü—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏.
        annotation_file (str): –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏—Å—Ö–æ–¥–Ω—ã—Ö –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π VisDrone.
        labels_dir (str): –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π YOLO.
    """
    os.makedirs(labels_dir, exist_ok=True)

    # –°–ø–∏—Å–æ–∫ –∫–ª–∞—Å—Å–æ–≤ VisDrone —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã–π –¥–ª—è YOLO
    class_names = [
        "ignored_region", "person", "person", "bicycle", "car", "car",
        "truck", "tricycle", "awning_tricycle", "bus", "motor", "others"
    ]

    def convert_box(size, box):
        dw = 1. / size[0]
        dh = 1. / size[1]
        return (box[0] + box[2] / 2) * dw, (box[1] + box[3] / 2) * dh, box[2] * dw, box[3] * dh

    with open(annotation_file, 'r') as f:
        all_rows = [x.split(',') for x in f.read().strip().splitlines()]

    for image_file in sorted(os.listdir(images_dir)):
        if not image_file.endswith('.jpg'):
            continue

        image_path = os.path.join(images_dir, image_file)
        output_file = os.path.join(labels_dir, image_file.replace('.jpg', '.txt'))

        img_size = Image.open(image_path).size
        frame_id = int(os.path.splitext(image_file)[0])

        lines = []
        for row in all_rows:
            if int(row[0]) != frame_id or int(row[-1]) == 1:  # –ü—Ä–æ–ø—É—Å–∫ "ignored regions" - —ç—Ç–æ –æ–±–ª–∞—Å—Ç–∏, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—â–∏–µ—Å—è –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏.
                continue

            cls_idx = int(row[7])  # –ò–Ω–¥–µ–∫—Å –∫–ª–∞—Å—Å–∞
            cls_name = class_names[cls_idx] if cls_idx < len(class_names) else f"class_{cls_idx}"
            xmin, ymin, width, height = map(int, row[2:6])
            box = convert_box(img_size, (xmin, ymin, width, height)) # –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –∏–∑ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ (YOLO-—Ñ–æ—Ä–º–∞—Ç).
            lines.append(f"{cls_name} {' '.join(f'{x:.6f}' for x in box)}\n")

        if lines:
            with open(output_file, 'w') as fl:
                fl.writelines(lines)

convert_folder_to_yolo(images_dir, annotation_file, labels_dir)

"""–°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–∞:

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª —Å–æ–∑–¥–∞–Ω –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫ –∏–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏:
"""

def create_video_in_h264(images_dir, output_video):
    """
    –°–æ–∑–¥–∞—ë—Ç –≤–∏–¥–µ–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ H.264 –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

    Args:
        images_dir (str): –ü—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏.
        output_video (str): –ò–º—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ.
    """
    import cv2
    import os
    import subprocess

    image_files = sorted([f for f in os.listdir(images_dir) if f.endswith('.jpg')])
    if not image_files:
        print("No images found in the directory.")
        return

    first_image = cv2.imread(os.path.join(images_dir, image_files[0]))
    height, width, _ = first_image.shape

    temp_video = "temp_output.mp4"
    fourcc = cv2.VideoWriter_fourcc(*'mp4v')
    out = cv2.VideoWriter(temp_video, fourcc, 30, (width, height)) # –°–æ–∑–¥–∞—ë—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ H.264.

    for image_file in image_files:
        frame = cv2.imread(os.path.join(images_dir, image_file))
        out.write(frame)

    out.release()

    # –ü–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ H.264
    cmd = [
        "ffmpeg", "-y", "-i", temp_video,
        "-vcodec", "libx264", "-pix_fmt", "yuv420p", "-movflags", "faststart",
        "-acodec", "aac", output_video
    ]
    try:
        subprocess.run(cmd, check=True) # Ffmpeg –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ –≤ –±–æ–ª–µ–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Ñ–æ—Ä–º–∞—Ç H.264.
        print(f"–í–∏–¥–µ–æ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ: {output_video}")
        os.remove(temp_video)
    except subprocess.CalledProcessError as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–∏–¥–µ–æ: {e.stderr}")

output_video = "visdrone_h264.mp4"
create_video_in_h264(images_dir, output_video)

"""###–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –∞–Ω–∞–ª–∏–∑–∞ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç FiftyOne. –í –Ω—ë–º –º–æ–∂–Ω–æ –≤–æ–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –≤–∏–¥–µ–æ —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏
"""

dataset_name = "visdrone_video_with_annotations"
if dataset_name in fo.list_datasets():
    fo.delete_dataset(dataset_name)

dataset = fo.Dataset(dataset_name)
sample = fo.Sample(filepath=output_video)

frame_annotations = []
for annotation_file in sorted(os.listdir(labels_dir)):
    if annotation_file.endswith('.txt'):
        frame_detections = []
        with open(os.path.join(labels_dir, annotation_file), 'r') as f:
            for line in f:
                fields = line.strip().split()
                cls_name = fields[0]
                x_center, y_center, bbox_width, bbox_height = map(float, fields[1:])
                bounding_box = [
                    x_center - bbox_width / 2,
                    y_center - bbox_height / 2,
                    bbox_width,
                    bbox_height,
                ]
                frame_detections.append(fo.Detection(label=cls_name, bounding_box=bounding_box))

        frame_annotations.append(fo.Detections(detections=frame_detections))

sample["frames"] = {
    idx + 1: {"ground_truth": frame_annotations[idx]} for idx in range(len(frame_annotations))
}
dataset.add_sample(sample)

session = fo.launch_app(dataset)

"""##–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –∏ –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π

–ë—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ YOLO —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–µ—Ä—Å–∏–π.

–ö–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –±—ã–ª–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫ –¥–∞–Ω–Ω—ã–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ apply_model, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ –¥–∞—Ç–∞—Å–µ—Ç–∞:
"""

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π YOLO —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π batch size
yolov3 = YOLO("yolov3.pt")

yolov5 = YOLO("yolov5n.pt")

yolov8 = YOLO("yolov8n.pt")

yolov11 = YOLO("yolo11n.pt")

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏
dataset.apply_model(yolov3, label_field="yolov3")
dataset.apply_model(yolov5, label_field="yolov5")
dataset.apply_model(yolov8, label_field="yolov8")
dataset.apply_model(yolov11, label_field="yolov11")

"""–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å FiftyOne –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏. –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –º–æ–∂–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏ –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤, –∞ —Ç–∞–∫–∂–µ –º–µ—Ç—Ä–∏–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏ –∫–ª–∞—Å—Å –æ–±—ä–µ–∫—Ç–∞. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ä–∞–≤–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∏ –æ—Ü–µ–Ω–∏—Ç—å –∏—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö."""

session = fo.launch_app(dataset)

"""–î–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ –±—ã–ª–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ evaluate_detections, –≤–∫–ª—é—á–∞—è mAP:"""

yolov3_results = dataset.evaluate_detections(
    "frames.yolov3",
    gt_field="frames.ground_truth",
    eval_key="eval_yolov3",
    compute_mAP=True,
)

yolov5_results = dataset.evaluate_detections(
    "frames.yolov5",
    gt_field="frames.ground_truth",
    eval_key="eval_yolov5",
    compute_mAP=True,
)

yolov8_results = dataset.evaluate_detections(
    "frames.yolov8",
    gt_field="frames.ground_truth",
    eval_key="eval_yolov8",
    compute_mAP=True,
)

yolov11_results = dataset.evaluate_detections(
    "frames.yolov11",
    gt_field="frames.ground_truth",
    eval_key="eval_yolov11",
    compute_mAP=True,
)

counts = dataset.count_values("frames.ground_truth.detections.label")
classes_top10 = sorted(counts, key=counts.get, reverse=True)[:10]

"""–í—ã–ø–æ–ª–Ω–µ–Ω –ø–æ–¥—Å—á–µ—Ç —á–∞—Å—Ç–æ—Ç—ã –∫–ª–∞—Å—Å–æ–≤ –≤ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è—Ö, –∞ —Ç–∞–∫–∂–µ –≤—ã–≤–æ–¥ –æ—Ç—á–µ—Ç–∞ –ø–æ –æ—Å–Ω–æ–≤–Ω—ã–º –º–µ—Ç—Ä–∏–∫–∞–º (precision, recall, f1-score) –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏:"""

print("Yolov3:")
yolov3_results.print_report(classes_top10)

print("Yolov5:")
yolov5_results.print_report(classes_top10)

print("Yolov8:")
yolov8_results.print_report(classes_top10)

print("Yolov11:")
yolov11_results.print_report(classes_top10)

"""##6. –û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π

–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π YOLO –±—ã–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏. –≠—Ç–∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ–∑–≤–æ–ª–∏–ª–∏ –æ—Ü–µ–Ω–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–µ–π –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.

–û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã:

###–ë–∞–∑–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

–í—ã–ø–æ–ª–Ω–µ–Ω–∞ –æ—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–∞–¥—Ä–æ–≤ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏:
"""

def bench_model(model, video_path):
    """
    –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ –æ–¥–Ω–æ–º –≤–∏–¥–µ–æ.

    Args:
        model: –ó–∞–≥—Ä—É–∂–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å YOLO.
        video_path (str): –ü—É—Ç—å –∫ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—É.

    Returns:
        dict: –°–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ (FPS –∏ –≤—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞).
    """
    cap = cv2.VideoCapture(video_path)
    inference_times = []

    total_frames = 0
    start_time = time.time()

    while cap.isOpened():
        ret, frame = cap.read()
        if not ret:
            break

        # –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –Ω–∞ –∫–∞–¥—Ä
        frame_start = time.time()
        _ = model.predict(source=frame, save=False) # –ó–∞–º–µ—Ä—è–µ—Ç—Å—è –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–≥–æ –∫–∞–¥—Ä–∞ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
        frame_time = time.time() - frame_start
        inference_times.append(frame_time)
        total_frames += 1

    elapsed_time = time.time() - start_time
    cap.release()

    avg_inference_time = sum(inference_times) / len(inference_times) if inference_times else 0
    fps = total_frames / elapsed_time if elapsed_time > 0 else 0

    return {
        "avg_inference_time": avg_inference_time,
        "fps": fps
    }

"""###–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:

–î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –±—ã–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏, –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–¥—Ä–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:
"""

def test_optimized(video_path, ckpt_path, batch_size=16):
    """
    –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø–∞–∫–µ—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –≤–∏–¥–µ–æ —Å –∑–∞–¥–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é,
    –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–¥–∞—ë—Ç –º–æ–¥–µ–ª—å –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –≤ bench_model.

    Args:
        video_path (str): –ü—É—Ç—å –∫ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—É.
        ckpt_path (str): –ü—É—Ç—å –∫ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–µ –º–æ–¥–µ–ª–∏.
        batch_size (int): –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞.

    Returns:
        dict: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø–æ–º–æ—â—å—é bench_model.
    """
    model = YOLO(ckpt_path)
    cap = cv2.VideoCapture(video_path)
    frames = []

    while cap.isOpened():
        ret, frame = cap.read()
        if not ret:
            break

        frames.append(frame)

        # –ö–∞–¥—Ä—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞.
        if len(frames) == batch_size:
            # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
            _ = model.predict(source=frames, save=False)
            frames = []

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∫–∞–¥—Ä–æ–≤
    if frames:
        _ = model.predict(source=frames, save=False)

    cap.release()

    # –í—ã–∑—ã–≤–∞–µ–º bench_model –¥–ª—è –æ—Ü–µ–Ω–∫–∏
    return bench_model(model, video_path)

"""###–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ FP16 –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –Ω–∞ GPU:

–ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ–æ—Ä–º–∞—Ç–∞ FP16:
"""

def test_fp16(video_path, ckpt_path):
    model = YOLO(ckpt_path)
    model.overrides["half"] = True  # –í–∫–ª—é—á–µ–Ω–∏–µ FP16 –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –Ω–∞ GPU
    return bench_model(model, video_path)

"""###–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:

–î–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π (YOLOv3, YOLOv5, YOLOv8, YOLOv11) –±—ã–ª–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω—ã —Ç–µ—Å—Ç—ã, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ—Ç–æ—Ä—ã—Ö –≤–∫–ª—é—á–∞—é—Ç —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–¥–Ω–æ–≥–æ –∫–∞–¥—Ä–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–¥—Ä–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É (FPS):
"""

def collect_and_display_results(models, video_path, test_functions):
    results = []
    for model_name, ckpt_path in models.items():
        for test_name, test_func in test_functions.items():
            print(f"\n--- {test_name}: {model_name} ---")
            test_result = test_func(video_path, ckpt_path)
            results.append({
                "Model": model_name,
                "Test Type": test_name,
                "Average Inference Time (s)": test_result["avg_inference_time"],
                "FPS": test_result["fps"]
            })

    return results

def display_results_table(results):
    """
    –í—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã.

    Args:
        results (list): –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
    """
    print("\n–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:")
    print(tabulate(results, headers="keys", tablefmt="grid"))

models = {
    "YOLOv3": "yolov3.pt",
    "YOLOv5": "yolov5n.pt",
    "YOLOv8": "yolov8n.pt",
    "YOLOv11": "yolo11n.pt"
}

test_functions = {
    "Optimized": lambda video_path, ckpt_path: test_optimized(video_path, ckpt_path, batch_size=16),
    "FP16": test_fp16,
}

video_path = "visdrone_h264.mp4"
results = collect_and_display_results(models, video_path, test_functions)

display_results_table(results)

"""##8. –í–´–í–û–î–´

###–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–í —Ö–æ–¥–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π YOLO –ø—Ä–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ FP16:
"""

display_results_table(results)

"""YOLOv8 –ø–æ–∫–∞–∑–∞–ª–∞ –Ω–∞–∏–ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∫–∞–¥—Ä–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—è –µ—ë –≤—ã—Å–æ–∫—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ FP16 –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏–ª–æ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π, –æ–¥–Ω–∞–∫–æ FPS –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–ª—Å—è, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ GPU.

YOLOv5 –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∞ –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–∞–∫ –≤ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ, —Ç–∞–∫ –∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FP16, —Å–æ—Ö—Ä–∞–Ω—è—è –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é.

–≠—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞—é—Ç, —á—Ç–æ –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏: –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ (YOLOv8) –∏–ª–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ (YOLOv5).

###–ü—Ä–æ–±–ª–µ–º—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è:

–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π, –æ—Å–æ–±–µ–Ω–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FP16, –Ω–∞–ø—Ä—è–º—É—é –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–ª–∏—á–∏—è –º–æ—â–Ω–æ–≥–æ GPU.

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ GPU –≤–ª–∏—è—é—Ç –Ω–∞ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ FPS.

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è FP16:

–•–æ—Ç—è FP16 —Å–æ–∫—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞, –ø—Ä–∏—Ä–æ—Å—Ç FPS –º–∏–Ω–∏–º–∞–ª–µ–Ω, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∑–∞–¥–∞—á —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

–≠—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –º–µ—Ç–æ–¥–∏–∫ –∏ –ø–æ–¥—Ö–æ–¥–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ —Ä–∞–±–æ—Ç–µ.
"""
